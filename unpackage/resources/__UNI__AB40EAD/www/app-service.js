if("undefined"==typeof Promise||Promise.prototype.finally||(Promise.prototype.finally=function(e){const a=this.constructor;return this.then((t=>a.resolve(e()).then((()=>t))),(t=>a.resolve(e()).then((()=>{throw t}))))}),"undefined"!=typeof uni&&uni&&uni.requireGlobal){const e=uni.requireGlobal();ArrayBuffer=e.ArrayBuffer,Int8Array=e.Int8Array,Uint8Array=e.Uint8Array,Uint8ClampedArray=e.Uint8ClampedArray,Int16Array=e.Int16Array,Uint16Array=e.Uint16Array,Int32Array=e.Int32Array,Uint32Array=e.Uint32Array,Float32Array=e.Float32Array,Float64Array=e.Float64Array,BigInt64Array=e.BigInt64Array,BigUint64Array=e.BigUint64Array}uni.restoreGlobal&&uni.restoreGlobal(Vue,weex,plus,setTimeout,clearTimeout,setInterval,clearInterval),function(e){"use strict";function a(e,a,...t){uni.__log__?uni.__log__(e,a,...t):console[e].apply(console,[...t,a])}__definePage("pages/index/index",{__name:"index",setup(t){const l=e.ref("60:E8:5B:6C:64:9F");e.onMounted((()=>{a("log","at pages/index/index.vue:113","load!"),a("log","at pages/index/index.vue:301","initblue"),uni.openBluetoothAdapter({success(e){a("log","at pages/index/index.vue:304","初始化蓝牙成功"),a("log","at pages/index/index.vue:305",e)},fail(e){a("log","at pages/index/index.vue:308","初始化蓝牙失败"),setTimeout((()=>{uni.showToast({title:"初始化蓝牙失败",icon:"error"})}),500),setTimeout((()=>{uni.showToast({title:"检查蓝牙打开没",icon:" error"})}),1e3),a("error","at pages/index/index.vue:322",e)}}),C(l,"auto")}));const o=()=>!1;let n=e.ref("@stop\r\n");const i=e.ref(!1),r=()=>{i.value=!0,p.value=!1,m.value=!1,T.value=n.value,a("log","at pages/index/index.vue:131",1+T.value),F();let e=setTimeout((()=>{clearTimeout(e),i.value=!1}),150)},s=e.ref("right0");let u=e.ref(0);const c=e.ref(!1);let v=e.ref("@forward speed1\r\n"),d=e.ref("@back speed1\r\n");const p=e.ref(!1),m=e.ref(!1),g=e.ref(!1),w=e.ref(!1);function f(e){if(c.value)return;switch(c.value=!0,"+"==e?(g.value=!0,u.value<4&&(u.value+=1)):"-"==e&&(w.value=!0,u.value>1&&(u.value-=1)),u.value){case 1:v.value="@forward speed1\r\n",d.value="@back speed1\r\n";break;case 2:v.value="@forward speed2\r\n",d.value="@back speed2\r\n";break;case 3:v.value="@forward speed3\r\n",d.value="@back speed3\r\n";break;case 4:v.value="@forward speed4\r\n",d.value="@back speed4\r\n"}a("log","at pages/index/index.vue:193","1",p.value),a("log","at pages/index/index.vue:194","2",m.value),1==p.value?(T.value=v.value,F()):1==m.value&&(a("log","at pages/index/index.vue:203",m.value),T.value=d.value,F()),a("log","at pages/index/index.vue:208",u.value),u.value>=1&&u.value<=4&&(s.value=`right${u.value}`),setTimeout((()=>{c.value=!1}),500);let t=setTimeout((()=>{clearTimeout(t),g.value=!1,w.value=!1}),250)}const h=e.ref(!1),x=e.ref(!1),y=e.ref(!1),E=e.ref(!1);function V(e){if(1==e){h.value=!0;let e=setTimeout((()=>{clearTimeout(e),h.value=!1}),250)}else if(2==e){x.value=!0;let e=setTimeout((()=>{clearTimeout(e),x.value=!1}),250)}else if(3==e){y.value=!0;let e=setTimeout((()=>{clearTimeout(e),y.value=!1}),250)}else if(4==e){E.value=!0;let e=setTimeout((()=>{clearTimeout(e),E.value=!1}),250)}}let T=e.ref(""),N=e.ref("@left\r\n"),k=e.ref("@right\r\n");function b(e){switch(e){case 1:T.value=N.value;break;case 2:T.value=k.value;break;case 3:T.value=v.value,p.value=!0,m.value=!1;break;case 4:T.value=d.value,m.value=!0,p.value=!1}a("log","at pages/index/index.vue:295",2+T.value),F()}const A=e.ref(!1);function C(e,t){"auto"==t?l.value=e.value:"noauto"==t&&(l.value=e),uni.createBLEConnection({deviceId:l.value,timeout:1e3,success(e){A.value=!0,B.value=!1,a("log","at pages/index/index.vue:347","连接成功"),a("log","at pages/index/index.vue:348",e),uni.showToast({title:"连接成功"})},fail(e){"createBLEConnection:fail operate time out"==e.errMsg?(a("log","at pages/index/index.vue:359","连接超时"),uni.showToast({title:"连接超时",icon:"error"}),setTimeout((()=>{uni.showToast({title:"请检查设备蓝牙",icon:"error"})}),1e3)):(a("log","at pages/index/index.vue:372","连接失败"),a("error","at pages/index/index.vue:373",e),uni.showToast({title:"连接失败",icon:"error"})),"createBLEConnection:fail already connect"==e.errMsg&&(a("log","at pages/index/index.vue:382","已有蓝牙连接"),setTimeout((()=>{uni.showToast({title:"已有蓝牙连接!",icon:"error"})}),1e3))}})}const B=e.ref(!1),_=e.ref("0000FFE0-0000-1000-8000-00805F9B34FB"),I=e.ref("0000FFE1-0000-1000-8000-00805F9B34FB");function F(){let e=T.value;const t=new ArrayBuffer(e.length),o=new DataView(t);for(var n=0;n<e.length;n++)o.setUint8(n,e.charAt(n).charCodeAt());uni.writeBLECharacteristicValue({deviceId:l.value,serviceId:_.value,characteristicId:I.value,value:t,success(e){a("log","at pages/index/index.vue:566","writeBLECharacteristicValue success",e.errMsg)},fail(e){a("error","at pages/index/index.vue:572",e),uni.showToast({title:"write指令发送失败",icon:"error"})}})}return e.ref(""),e.ref(""),(t,n)=>(e.openBlock(),e.createElementBlock("view",{class:"body"},[e.createElementVNode("view",{class:"state-box"},[e.createElementVNode("view",{class:"bluetooth-state"},[e.createElementVNode("view",{class:"text-state"},"连接状态:"),e.createElementVNode("view",{class:e.normalizeClass(["light-state",{connected:A.value}])},null,2)]),e.createElementVNode("textarea",{name:"",id:"",cols:"30",rows:"10",class:"text_input"}),e.createElementVNode("view",{class:"state-box_bg"})]),e.createElementVNode("view",{class:"bluetooth-set"},[e.createElementVNode("view",{class:"connect",onClick:n[0]||(n[0]=e=>C(l.value,"noauto"))},[e.createElementVNode("image",{src:"/static/bluetooth.svg",mode:"",class:"bluetooth"}),e.createElementVNode("view",{class:"connect_text"}," 连接蓝牙 ")]),e.createElementVNode("view",{class:"disconnect",onClick:n[1]||(n[1]=e=>{return t=l.value,l.value=t,void uni.closeBLEConnection({deviceId:l.value,success(e){B.value?uni.showToast({title:"蓝牙已断开"}):(a("log","at pages/index/index.vue:406","断开连接成功"),a("log","at pages/index/index.vue:407",e),uni.showToast({title:"断开连接成功",icon:"success"}),B.value=!0)},fail(e){a("log","at pages/index/index.vue:421","断开连接失败"),a("log","at pages/index/index.vue:422",e),uni.showToast({title:"断开连接失败",icon:"fail"})}});var t})}," 断开连接 "),e.createElementVNode("view",{class:"connect_bg"}),e.createElementVNode("view",{class:"disconnect_bg"}),e.createElementVNode("view",{class:"bluetooth-set_bg"})]),e.createElementVNode("view",{class:"key-box"},[e.createElementVNode("view",{class:e.normalizeClass(["LeftKey",{shrink1:h.value}]),onClick:n[2]||(n[2]=e=>b(1)),onTouchstart:n[3]||(n[3]=e=>V(1))},[e.createElementVNode("view",{class:"key left"}),e.createElementVNode("view",{class:"triangle"})],34),e.createElementVNode("view",{class:e.normalizeClass(["RightKey",{shrink2:x.value}]),onClick:n[4]||(n[4]=e=>b(2)),onTouchstart:n[5]||(n[5]=e=>V(2))},[e.createElementVNode("view",{class:"key right"}),e.createElementVNode("view",{class:"triangle"})],34),e.createElementVNode("view",{class:e.normalizeClass(["ForwardKey",{shrink3:y.value}]),onClick:n[6]||(n[6]=e=>b(3)),onTouchstart:n[7]||(n[7]=e=>V(3))},[e.createElementVNode("view",{class:"key forward"}),e.createElementVNode("view",{class:"triangle"})],34),e.createElementVNode("view",{class:e.normalizeClass(["BackKey",{shrink4:E.value}]),onClick:n[8]||(n[8]=e=>b(4)),onTouchstart:n[9]||(n[9]=e=>V(4))},[e.createElementVNode("view",{class:"key back"}),e.createElementVNode("view",{class:"triangle"})],34),e.createElementVNode("view",{class:"Speed-Container"},[e.createElementVNode("view",{style:{height:"80px",display:"flex","align-items":"center"}},[e.createElementVNode("scroll-view",{"scroll-y":"true",class:"Speed-Box","scroll-into-view":s.value,"scroll-with-animation":"true"},[e.createElementVNode("view",{onTouchmove:e.withModifiers(o,["stop","prevent"]),class:"Speed-item",id:"right1"},"低速",40,["onTouchmove"]),e.createElementVNode("view",{onTouchmove:e.withModifiers(o,["stop","prevent"]),class:"Speed-item",id:"right2"},"中速",40,["onTouchmove"]),e.createElementVNode("view",{onTouchmove:e.withModifiers(o,["stop","prevent"]),class:"Speed-item",id:"right3"},"高速",40,["onTouchmove"]),e.createElementVNode("view",{onTouchmove:e.withModifiers(o,["stop","prevent"]),class:"Speed-item",id:"right4"},"极速",40,["onTouchmove"])],8,["scroll-into-view"])]),e.createElementVNode("view",{class:"select-speed-box"},[e.createElementVNode("image",{src:"/static/uparrow.svg",mode:"",class:e.normalizeClass(["arrow-up",{upShrink:g.value}]),onClick:n[10]||(n[10]=e=>f("+")),disabled:c.value},null,10,["disabled"]),e.createElementVNode("image",{src:"/static/uparrow.svg",mode:"",class:e.normalizeClass(["arrow-down",{downShrink:w.value}]),onClick:n[11]||(n[11]=e=>f("-"))},null,2)])]),e.createElementVNode("view",{class:e.normalizeClass(["stopButton",{stopShrink:i.value}]),onClick:r}," 急停 ",2),e.createElementVNode("view",{class:"backGround3"})])]))}});const t={onLaunch:function(){a("log","at App.vue:4","App Launch")},onShow:function(){a("log","at App.vue:7","App Show")},onHide:function(){a("log","at App.vue:10","App Hide")}};const{app:l,Vuex:o,Pinia:n}={app:e.createVueApp(t)};uni.Vuex=o,uni.Pinia=n,l.provide("__globalStyles",__uniConfig.styles),l._component.mpType="app",l._component.render=()=>{},l.mount("#app")}(Vue);
