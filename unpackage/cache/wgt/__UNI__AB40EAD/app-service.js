if("undefined"==typeof Promise||Promise.prototype.finally||(Promise.prototype.finally=function(e){const a=this.constructor;return this.then((t=>a.resolve(e()).then((()=>t))),(t=>a.resolve(e()).then((()=>{throw t}))))}),"undefined"!=typeof uni&&uni&&uni.requireGlobal){const e=uni.requireGlobal();ArrayBuffer=e.ArrayBuffer,Int8Array=e.Int8Array,Uint8Array=e.Uint8Array,Uint8ClampedArray=e.Uint8ClampedArray,Int16Array=e.Int16Array,Uint16Array=e.Uint16Array,Int32Array=e.Int32Array,Uint32Array=e.Uint32Array,Float32Array=e.Float32Array,Float64Array=e.Float64Array,BigInt64Array=e.BigInt64Array,BigUint64Array=e.BigUint64Array}uni.restoreGlobal&&uni.restoreGlobal(Vue,weex,plus,setTimeout,clearTimeout,setInterval,clearInterval),function(e){"use strict";function a(e,a,...t){uni.__log__?uni.__log__(e,a,...t):console[e].apply(console,[...t,a])}const t=a=>(t,l=e.getCurrentInstance())=>{!e.isInSSRComponentSetup&&e.injectHook(a,t,l)},l=t("onShow"),o=t("onHide"),n=t("onLaunch");__definePage("pages/index/index",{__name:"index",setup(t){const l=()=>{const t=e.ref("@avoidObstacle\r\n");B.value=t.value,P(),a("log","at pages/index/index.vue:119","bi")},o=e.ref(!1),n=e.ref(!1),i=e.ref(!1),r=e.ref(!1),s=e.ref(!1),u=e.ref(!1),c=e.ref("60:E8:5B:6C:64:9F");e.onMounted((()=>{let e=uni.getSystemInfoSync().platform;"ios"==e?(a("log","at pages/index/index.vue:136","ios"),o.value=!1,n.value=!1,i.value=!1,r.value=!1,s.value=!1,u.value=!1):"android"==e&&(a("log","at pages/index/index.vue:146","android"),o.value=!0,n.value=!0,i.value=!0,r.value=!0,s.value=!0,u.value=!0),a("log","at pages/index/index.vue:155","load!"),a("log","at pages/index/index.vue:368","initblue"),uni.openBluetoothAdapter({success(e){a("log","at pages/index/index.vue:371","初始化蓝牙成功"),a("log","at pages/index/index.vue:372",e)},fail(e){a("log","at pages/index/index.vue:375","初始化蓝牙失败"),setTimeout((()=>{uni.showToast({title:"初始化蓝牙失败",icon:"error"})}),500),setTimeout((()=>{uni.showToast({title:"检查蓝牙打开没",icon:" error"})}),1e3),a("error","at pages/index/index.vue:389",e)}}),z(c,"auto")}));const v=()=>!1;let d=e.ref("@stop\r\n");const p=e.ref(!1),m=e=>{if(B.value=d.value,a("log","at pages/index/index.vue:171",1+B.value),"stop"==e)setTimeout((()=>{P()}),250);else if(" "==e){p.value=!0,y.value=!1,E.value=!1,P();let e=setTimeout((()=>{clearTimeout(e),p.value=!1}),150)}},g=e.ref("right0");let f=e.ref(0);const h=e.ref(!1);let w=e.ref("@forward speed1\r\n"),x=e.ref("@back speed1\r\n");const y=e.ref(!1),E=e.ref(!1),T=e.ref(!1),V=e.ref(!1);function k(e){if(h.value)return;switch(h.value=!0,"+"==e?(T.value=!0,f.value<4&&(f.value+=1)):"-"==e&&(V.value=!0,f.value>1&&(f.value-=1)),f.value){case 1:w.value="@forward speed1\r\n",x.value="@back speed1\r\n";break;case 2:w.value="@forward speed2\r\n",x.value="@back speed2\r\n";break;case 3:w.value="@forward speed3\r\n",x.value="@back speed3\r\n";break;case 4:w.value="@forward speed4\r\n",x.value="@back speed4\r\n"}a("log","at pages/index/index.vue:246","1",y.value),a("log","at pages/index/index.vue:247","2",E.value),1==y.value?B.value=w.value:1==E.value&&(a("log","at pages/index/index.vue:255",E.value),B.value=x.value),a("log","at pages/index/index.vue:259",f.value),f.value>=1&&f.value<=4&&(g.value=`right${f.value}`),setTimeout((()=>{h.value=!1}),500);let t=setTimeout((()=>{clearTimeout(t),T.value=!1,V.value=!1}),250)}const b=e.ref(!1),N=e.ref(!1),A=e.ref(!1),C=e.ref(!1);function _(e){if(1==e){b.value=!0;let e=setTimeout((()=>{clearTimeout(e),b.value=!1}),250)}else if(2==e){N.value=!0;let e=setTimeout((()=>{clearTimeout(e),N.value=!1}),250)}else if(3==e){A.value=!0;let e=setTimeout((()=>{clearTimeout(e),A.value=!1}),250)}else if(4==e){C.value=!0;let e=setTimeout((()=>{clearTimeout(e),C.value=!1}),250)}}let B=e.ref(""),S=e.ref("@left\r\n"),I=e.ref("@right\r\n");function F(e){let t=0;switch("left"==e?t=1:"right"==e?t=2:"forward"==e?t=3:"back"==e&&(t=4),a("log","at pages/index/index.vue:340",t),t){case 1:B.value=S.value;break;case 2:B.value=I.value;break;case 3:B.value=w.value,y.value=!0,E.value=!1;break;case 4:B.value=x.value,E.value=!0,y.value=!1}a("log","at pages/index/index.vue:362",B.value),P()}const U=e.ref(!1);function z(e,t){"auto"==t?c.value=e.value:"noauto"==t&&(c.value=e),uni.createBLEConnection({deviceId:c.value,timeout:1e3,success(e){U.value=!0,L.value=!1,a("log","at pages/index/index.vue:414","连接成功"),a("log","at pages/index/index.vue:415",e),uni.showToast({title:"连接成功"})},fail(e){"createBLEConnection:fail operate time out"==e.errMsg?(a("log","at pages/index/index.vue:426","连接超时"),uni.showToast({title:"连接超时",icon:"error"}),setTimeout((()=>{uni.showToast({title:"请检查设备蓝牙",icon:"error"})}),1e3)):(a("log","at pages/index/index.vue:439","连接失败"),a("error","at pages/index/index.vue:440",e),uni.showToast({title:"连接失败",icon:"error"})),"createBLEConnection:fail already connect"==e.errMsg&&(a("log","at pages/index/index.vue:449","已有蓝牙连接"),setTimeout((()=>{uni.showToast({title:"已有蓝牙连接!",icon:"error"})}),1e3))}})}const L=e.ref(!1),K=e.ref("0000FFE0-0000-1000-8000-00805F9B34FB"),M=e.ref("0000FFE1-0000-1000-8000-00805F9B34FB");function P(){let e=B.value;const t=new ArrayBuffer(e.length),l=new DataView(t);for(var o=0;o<e.length;o++)l.setUint8(o,e.charAt(o).charCodeAt());uni.writeBLECharacteristicValue({deviceId:c.value,serviceId:K.value,characteristicId:M.value,value:t,success(e){a("log","at pages/index/index.vue:633","writeBLECharacteristicValue success",e.errMsg)},fail(e){a("error","at pages/index/index.vue:639",e),uni.showToast({title:"write指令发送失败",icon:"error"})}})}return e.ref(""),e.ref(""),(t,d)=>(e.openBlock(),e.createElementBlock("view",{class:"body"},[e.createElementVNode("view",{class:"state-box"},[e.createElementVNode("view",{class:"bluetooth-state"},[e.createElementVNode("view",{class:"text-state"},"连接状态:"),e.createElementVNode("view",{class:e.normalizeClass(["light-state",{connected:U.value}])},null,2)]),e.createElementVNode("view",{class:"bizhang",onClick:l}," 避障模式 "),e.createElementVNode("textarea",{name:"",id:"",cols:"30",rows:"10",class:"text_input"}),e.createElementVNode("view",{class:"state-box_bg"})]),e.createElementVNode("view",{class:"bluetooth-set"},[e.createElementVNode("view",{class:"connect",onClick:d[0]||(d[0]=e=>z(c.value,"noauto"))},[e.createElementVNode("image",{src:"/static/bluetooth.svg",mode:"",class:"bluetooth"}),e.createElementVNode("view",{class:"connect_text"}," 连接蓝牙 ")]),e.createElementVNode("view",{class:"disconnect",onClick:d[1]||(d[1]=e=>{return t=c.value,c.value=t,void uni.closeBLEConnection({deviceId:c.value,success(e){L.value?uni.showToast({title:"蓝牙已断开"}):(a("log","at pages/index/index.vue:473","断开连接成功"),a("log","at pages/index/index.vue:474",e),uni.showToast({title:"断开连接成功",icon:"success"}),L.value=!0)},fail(e){a("log","at pages/index/index.vue:488","断开连接失败"),a("log","at pages/index/index.vue:489",e),uni.showToast({title:"断开连接失败",icon:"fail"})}});var t})}," 断开连接 "),e.createElementVNode("view",{class:"connect_bg"}),e.createElementVNode("view",{class:"disconnect_bg"}),e.createElementVNode("view",{class:"bluetooth-set_bg"})]),e.createElementVNode("view",{class:"key-box"},[e.createElementVNode("view",{class:e.normalizeClass(["LeftKey",{shrink1:b.value&!o.value,adapShrink1:b.value&o.value,adapLeftKey:o.value}]),onTouchend:d[2]||(d[2]=e=>m("stop")),onTouchstart:d[3]||(d[3]=e=>(F("left"),_(1)))},[e.createElementVNode("view",{class:"key left"}),e.createElementVNode("view",{class:"triangle"})],34),e.createElementVNode("view",{class:e.normalizeClass(["RightKey",{shrink2:N.value,adapShrink2:N.value&n.value,adapRightKey:n.value}]),onTouchend:d[4]||(d[4]=e=>m("stop")),onTouchstart:d[5]||(d[5]=e=>(F("right"),_(2)))},[e.createElementVNode("view",{class:"key right"}),e.createElementVNode("view",{class:"triangle"})],34),e.createElementVNode("view",{class:e.normalizeClass(["ForwardKey",{shrink3:A.value,adapShrink3:A.value&i.value,adapForwardKey:i.value}]),onTouchend:d[6]||(d[6]=e=>m("stop")),onTouchstart:d[7]||(d[7]=e=>(F("forward"),_(3)))},[e.createElementVNode("view",{class:"key forward"}),e.createElementVNode("view",{class:"triangle"})],34),e.createElementVNode("view",{class:e.normalizeClass(["BackKey",{shrink4:C.value,adapShrink4:C.value&r.value,adapBackKey:r.value}]),onTouchend:d[8]||(d[8]=e=>m("stop")),onTouchstart:d[9]||(d[9]=e=>(F("back"),_(4)))},[e.createElementVNode("view",{class:"key back"}),e.createElementVNode("view",{class:"triangle"})],34),e.createElementVNode("view",{class:e.normalizeClass(["Speed-Container",{adapSpeedContainer:u.value}])},[e.createElementVNode("view",{style:{height:"80px",display:"flex","align-items":"center"}},[e.createElementVNode("scroll-view",{"scroll-y":"true",class:"Speed-Box","scroll-into-view":g.value,"scroll-with-animation":"true"},[e.createElementVNode("view",{onTouchmove:e.withModifiers(v,["stop","prevent"]),class:"Speed-item",id:"right1"},"低速",40,["onTouchmove"]),e.createElementVNode("view",{onTouchmove:e.withModifiers(v,["stop","prevent"]),class:"Speed-item",id:"right2"},"中速",40,["onTouchmove"]),e.createElementVNode("view",{onTouchmove:e.withModifiers(v,["stop","prevent"]),class:"Speed-item",id:"right3"},"高速",40,["onTouchmove"]),e.createElementVNode("view",{onTouchmove:e.withModifiers(v,["stop","prevent"]),class:"Speed-item",id:"right4"},"极速",40,["onTouchmove"])],8,["scroll-into-view"])]),e.createElementVNode("view",{class:"select-speed-box"},[e.createElementVNode("image",{src:"/static/uparrow.svg",mode:"",class:e.normalizeClass(["arrow-up",{upShrink:T.value}]),onClick:d[10]||(d[10]=e=>k("+")),disabled:h.value},null,10,["disabled"]),e.createElementVNode("image",{src:"/static/uparrow.svg",mode:"",class:e.normalizeClass(["arrow-down",{downShrink:V.value}]),onClick:d[11]||(d[11]=e=>k("-"))},null,2)])],2),e.createElementVNode("view",{class:e.normalizeClass(["stopButton",{stopShrink:p.value,adapStopShrink:p.value&s.value,adapStopKey:s.value}]),onClick:d[12]||(d[12]=e=>m(" "))}," 急停 ",2),e.createElementVNode("view",{class:"backGround3"})])]))}});const i={__name:"App",setup:e=>(n((()=>{a("log","at App.vue:5","App Launch"),a("log","at App.vue:7",uni.getWindowInfo().screenWidth)})),l((()=>{a("log","at App.vue:11","App Show")})),o((()=>{a("log","at App.vue:16","App Hide")})),()=>{})};const{app:r,Vuex:s,Pinia:u}={app:e.createVueApp(i)};uni.Vuex=s,uni.Pinia=u,r.provide("__globalStyles",__uniConfig.styles),r._component.mpType="app",r._component.render=()=>{},r.mount("#app")}(Vue);
